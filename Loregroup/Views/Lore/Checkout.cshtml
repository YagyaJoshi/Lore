@model Loregroup.Core.ViewModels.CheckoutViewModel
@{
    ViewBag.Title = "Checkout";
    Layout = "~/Views/Shared/_MasterFrontend.cshtml";
}


@*<script src="https://almsaeedstudio.com/themes/AdminLTE/plugins/datepicker/bootstrap-datepicker.js"></script>
    <link rel="stylesheet" href="https://almsaeedstudio.com/themes/AdminLTE/plugins/datepicker/datepicker3.css" />*@

@*<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />*@


<script type="text/javascript">

    $(function () { //will trigger when the document is ready
        $('.datepicker').datepicker({
            format: "mm/dd/yyyy",
            //dateFormat: 'yy-mm-dd',
            changeMonth: true,
            changeYear: true,
            autoclose: true,
            yearRange: "-1:+50",
            todayHighlight: true,
            //defaultDate:'now'
        }); //Initialise any date pickers
    });

</script>
<style type="text/css">

    #ordernotes {
        /*height:150px;*/
    }
</style>

<!-- main content -->
<section class="form-box">
    <div class="container">

        <div class="row">
            <div class="col-sm-12 col-sm-offset-1 col-md-12 col-md-offset-2 col-lg-12 col-lg-offset-3" style="margin:auto;">

                @if (Model.CartList.Count > 0)
                {
                    <!-- Form Wizard -->
                    <div class="form-wizard form-header-classic form-body-classic">
                        <!-- Form progress -->
                        <div class="form-wizard-steps form-wizard-tolal-steps-4">
                            <div class="form-wizard-progress">
                                <div class="form-wizard-progress-line" data-now-value="18.25" data-number-of-steps="2" style="width: 22.25%;"></div>
                            </div>
                            <!-- Step 1 -->
                            <!-- <div class="form-wizard-step active">
                                <div class="form-wizard-step-icon">
                                <span>1</span>
                                </div>
                                <p>BILLING ADDRESS</p>
                            </div> -->
                            <!-- Step 1 -->
                            <!-- Step 2 -->
                            <div class="form-wizard-step active">
                                <div class="form-wizard-step-icon">
                                    <!-- <i class="fa fa-user" aria-hidden="true"></i> -->
                                    <span>1</span>
                                </div>
                                <p>Review Order</p>
                            </div>
                            <!-- Step 2 -->
                            <!-- Step 3 -->
                            <div class="form-wizard-step">
                                <div class="form-wizard-step-icon">
                                    <!-- <i class="fa fa-university" aria-hidden="true"></i> -->
                                    <span>2</span>
                                </div>
                                <p>Confirm</p>
                            </div>
                            <!-- Step 3 -->
                            <!-- Step 4 -->
                            <!-- 	<div class="form-wizard-step">
                                    <div class="form-wizard-step-icon">
                                    <span>4</span>
                                    </div>
                                    <p>Shipping</p>
                                </div> -->
                            <!-- Step 4 -->
                        </div>
                        <!-- Form progress -->
                        <!-- Form Step 2 -->
                        <fieldset style="display:block">
                            <!-- Progress Bar -->
                            <!-- <div class="progress"> -->
                            <!-- <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 50%"> -->
                            <!-- </div> -->
                            <!-- </div> -->
                            <!-- Progress Bar -->
                            <!-- <h4>Personal Information : <span>Step 2 - 4</span></h4> -->
                            <div class="m-b-50 m-t-30">
                                <h5>Shopping Cart</h5>
                                <hr>
                                <table>
                                    <tr>
                                        <th>Product</th>
                                        <th>@Model.Countrynme  Size</th>
                                        @*<th>Size</th>*@
                                        <th>Color</th>
                                        <th>Unit Price</th>
                                        <th>Quantity</th>
                                        <th>Total</th>
                                        <th></th>
                                    </tr>

                                    @foreach (var item in Model.CartList)
                                    {
                                        <tr>
                                            <th>@item.ProductName</th>
                                            <th>@item.SizeUK</th>
                                            <th>@item.ColourName</th>
                                            <th>@item.PriceUSD</th>
                                            <th>@item.Quantity</th>
                                            <th>@item.Total</th>
                                            <th><a onclick="DeleteItem('@item.Id')">Remove</a></th>
                                        </tr>

                                    }

                                    <tr>
                                        <th></th>
                                        <th></th>

                                        <th></th>
                                        <th></th>
                                        <th>Total:</th>

                                        <th>@Model.TotalAmount</th>
                                    </tr>
                                    <tr>
                                        <th></th>
                                        <th></th>

                                        <th></th>
                                        <th></th>
                                        <th>Shipping Charge:</th>

                                        <th>@Model.ShippingCharge</th>
                                    </tr>
                                    <tr>
                                        <th></th>
                                        <th></th>

                                        <th></th>
                                        <th></th>
                                        <th>Grand Total:</th>

                                        <th>@Model.GrandTotalAmount</th>
                                    </tr>
                                </table>

                                <hr>
                            </div>

                            <div class="m-b-50">
                                <h5>Shipping Information</h5>
                                <hr>
                                <table>
                                    <tr>
                                        <th>Name:</th>
                                        <th>Email:</th>
                                        <th>Phone:</th>
                                        <th>Country:</th>
                                    </tr>
                                    <tr>
                                        <td>@Model.UserModel.CustomerFullName</td>
                                        <td>@Model.UserModel.EmailId</td>
                                        <td>@Model.UserModel.MobileNo</td>
                                        <td>@Model.UserModel.Country</td>
                                    </tr>

                                    <tr>
                                        <th>City:</th>
                                        <th>State:</th>
                                        <th>Zip Code:</th>
                                        @*<th>Country:</th>*@
                                    </tr>
                                    <tr>
                                        <td>@Model.UserModel.City</td>
                                        <td>@Model.UserModel.StateName</td>
                                        <td>@Model.UserModel.ZipCode</td>
                                        @*<td>@Model.UserModel.CustomerFullName</td>*@
                                    </tr>

                                </table>
                                <table>
                                    <tr>
                                        <th>Bride's Name:</th>
                                        <th>PO (Purchase Order):</th>
                                        <th>Wear Date (MM/DD/YYYY):</th>
                                        <th>Delivery Date (MM/DD/YYYY):</th>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-group" style="margin-right:10px;">
                                                @Html.BsTextBoxWithPHFor(model => model.BridesName)
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group" style="margin-right:10px;">
                                                @Html.BsTextBoxWithPHFor(model => model.PurchaseOrderNumber)
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group" style="margin-right:10px;">
                                                @Html.TextBoxFor(model => model.WearDate, new { @class = "form-control datepicker", placeholder = "mm/dd/yyyy" })
                                            </div>
                                        </td>
                                        <td>
                                            <div class="form-group" style="margin-right:10px;">
                                                @Html.TextBoxFor(model => model.DeliveryDate, new { @class = "form-control datepicker", placeholder = "mm/dd/yyyy" })
                                            </div>
                                        </td>
                                        @*<td>@Model.UserModel.CustomerFullName</td>*@
                                    </tr>
                                </table>
                            </div>

                            <div class="m-b-50">
                                <h5>Notes :</h5>
                                <hr>
                                <div class="form-group">
                                    @*@Html.Label("Please type your notes here and requested delivery date", new { style = "width:100%" })*@
                                    @Html.BsTextAreaFor(model => model.OrderNotes, new { id = "ordernotes", Style = "height:200px; min-height:150px;" }) @*,placeholder = "please type your notes here and requested delivery date"*@
                                    @*@Html.BsTextBoxWithPHFor(model => model.OrderNotes, new { id = "ordernotes", rows = 6 })*@
                                    @*@Html.ValidationMessageFor(model => model.OrderNotes)*@
                                    @*@Html.TextAreaFor(model => model.OrderNotes, new { @class = "form-control", @rows = 6 })*@
                                    @*<textarea id="ordernotes" name="Description"  placeholder="Order Note"></textarea>*@
                                </div>
                                <hr>
                            </div>

                            @*<div class="m-b-50">
                                    <h5>Payment information</h5>
                                    <hr>
                                    Card number:XXX-XXX-XXX-7224
                                </div>*@

                            <div class="form-wizard-buttons">
                                @*<button type="button" class="btn btn-previous">Previous</button>*@
                                <button type="submit" onclick="return SaveOrder();" class="btn btn-next">Confirm Order</button>
                            </div>
                        </fieldset>
                        <!-- Form Step 2 -->
                        <!-- Form Step 3 -->
                        <fieldset id="orderdone" style="display:none">
                            <!-- Progress Bar -->
                            <!-- <div class="progress"> -->
                            <!-- <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%"> -->
                            <!-- </div> -->
                            <!-- </div> -->
                            <!-- Progress Bar -->
                            <!-- <h4>Bank Information: <span>Step 3 - 4</span></h4> -->
                            <div style="margin:30px 0;">
                                <div class="success-circle">
                                    <i class="fa fa-check" aria-hidden="true"></i>
                                </div>
                            </div>
                            <h1>Congratulation! Your order has been processed</h1>
                            @*<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempus dolor ante, ut luctus mi faucibus a. Ut eu tincidunt neque. Proin porttitor id ligula id placerat. Integer nec nulla varius, dapibus libero quis, semper eros. Aliquam erat volutpat. Proin volutpat tellus vel purus interdum euismod.</p>*@
                            <div class="form-wizard-buttons">
                                @*<button type="button" class="btn btn-previous">Previous</button>*@
                                <button type="button" class="btn btn-next">Back To Home</button>
                            </div>
                        </fieldset>
                        <!-- Form Step 3 -->
                    </div>
                    <!-- Form Wizard -->
                }
                else
                {
                    <div>
                        <div style="margin:30px 0;">
                            <div class="success-circle">
                                <i class="fa fa-shopping-cart" aria-hidden="true"></i>
                            </div>
                        </div>
                        <center> <h1> Your Cart Is Empty. You have not Logged - In.</h1> </center>
                    </div>
                }

            </div>
        </div>

    </div>
</section>
<!-- main content -->

<script type="text/javascript">

    function DeleteItem(tempid) {

        $.ajax({

            url: '/Lore/DeleteItemFromTempcart?TempId=' + tempid,
            //type: 'GET',
            crossDomain: true,
            //data: JSON.stringify(employee),
            //data: { emailid: abc, password: def },
            //dataType: 'json',
            contentType: "application/json",
            //contentType: "application/xml; charset=utf-8",
            //beforeSend: function () {
            //    $("#loadingImage").show();
            //},
            //complete: function () {
            //    $("#loadingImage").hide();
            //},
            beforeSend: function () {
                return confirm("Are you sure want to delete Item !");
            },
            success: function (data) {
                //alert("Thank you for contacting us!");
                if (data == 1) {
                    alert("Item Removed!");
                    //window.location.href = "http://www.dev1.connekt.in/Lore/Checkout";
                    document.location = '@Url.Action("Checkout", "Lore")';
                    return true;
                }
                //else if (data == 2) {
                //    return true;
                //}
                else {
                    alert("Server Error ! please try later.");
                    return false;
                }
                //window.location.href = "http://www.bookcommerce.com/";
                return false;
            },
            error: function (data) {
                console.log(data);
                alert("Some error occured");
                return false;
            }

        });

    }



    function SaveOrder() {
        event.preventDefault();
        var bridesName = $("#BridesName").val();
        var poNumber = $("#PurchaseOrderNumber").val();
        //if (bridesName != "" && bridesName != null) {
        //}
        //else {
        //    alert("Enter Bride's Name.");
        //    $("#BridesName").focus();
        //    return false;
        //}

        var wearDate = $("#WearDate").val();
        //if (wearDate != "" && wearDate != null) {
        //}
        //else {
        //    alert("Select Wear Date.");
        //    $("#WearDate").focus();
        //    return false;
        //}

        var deliveryDate = $("#DeliveryDate").val();
        //if (deliveryDate != "" && deliveryDate != null) {
        //}
        //else {
        //    alert("Select Delivery Date.");
        //    $("#DeliveryDate").focus();
        //    return false;
        //}

        var notes = $("#ordernotes").val();

        $.ajax({

            url: '/Lore/SaveFrontendOrder?bridesName=' + bridesName + '&purchaseOrderNumber=' + poNumber + '&wearDate=' + wearDate + '&deliveryDate=' + deliveryDate + '&Notes=' + notes,
            //type: 'GET',
            crossDomain: true,
            //data: JSON.stringify(employee),
            //data: { emailid: abc, password: def },
            //dataType: 'json',
            contentType: "application/json",
            //contentType: "application/xml; charset=utf-8",
            //beforeSend: function () {
            //    $("#loadingImage").show();
            //},
            //complete: function () {
            //    $("#loadingImage").hide();
            //},
            beforeSend: function () {
                return confirm("Are you sure want to proceed the Order!");
            },
            success: function (data) {
                //alert("Thank you for contacting us!");
                if (data == 1) {
                    $("#orderdone").show();
                    alert("Order Saved ! A member of our team will be in touch with delivery date.");
                    //window.location.href = "http://www.dev1.connekt.in/Lore/Checkout";
                    document.location = '@Url.Action("OrderHistory", "Lore")';
                    return true;
                }
                    //else if (data == 2) {
                    //    return true;
                    //}
                else {
                    alert("Server Error ! please try later.");
                    return false;
                }
                //window.location.href = "http://www.bookcommerce.com/";
                return false;
            },
            error: function (data) {
                console.log(data);
                alert("Some error occured");
                return false;
            }

        });
        return false;
    }

</script>

@*<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">*@
@*<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>*@
<script src="~/Content/moment.js"></script>
<script src="~/Content/jquery-1.11.3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.js"></script>

<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.min.css" />
<script type="text/javascript">
    $(function () { //will trigger when the document is ready
        $('.datepicker').datepicker({
            format: "mm/dd/yyyy",
            //dateFormat: 'mm/dd/yyyy',
            changeMonth: true,
            changeYear: true,
            autoclose: true,
            yearRange: "-1:+50",
            todayHighlight: true,
            //setDate: new Date(),
        }); //Initialise any date pickers
    });
</script>


